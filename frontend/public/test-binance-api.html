<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance API è¿æ¥æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #fff;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #2a2a2a;
        }
        .status {
            padding: 5px 10px;
            border-radius: 3px;
            font-weight: bold;
        }
        .success { background-color: #4a5d23; color: #90c695; }
        .error { background-color: #5d2323; color: #c69090; }
        .loading { background-color: #4a4a23; color: #c6c690; }
        pre {
            background-color: #333;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 3px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #005a9c;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Binance API è¿æ¥æµ‹è¯•</h1>

    <div class="test-section">
        <h2>ğŸ“Š æµ‹è¯• 24h Ticker API</h2>
        <button onclick="testTickerAPI()">æµ‹è¯• Ticker API</button>
        <div id="ticker-status" class="status loading">ç­‰å¾…æµ‹è¯•...</div>
        <pre id="ticker-result"></pre>
    </div>

    <div class="test-section">
        <h2>ğŸ“ˆ æµ‹è¯• Kçº¿æ•°æ® API</h2>
        <button onclick="testKlineAPI()">æµ‹è¯• Kline API</button>
        <div id="kline-status" class="status loading">ç­‰å¾…æµ‹è¯•...</div>
        <pre id="kline-result"></pre>
    </div>

    <div class="test-section">
        <h2>ğŸ“š æµ‹è¯•è®¢å•ç°¿ API</h2>
        <button onclick="testDepthAPI()">æµ‹è¯• Depth API</button>
        <div id="depth-status" class="status loading">ç­‰å¾…æµ‹è¯•...</div>
        <pre id="depth-result"></pre>
    </div>

    <div class="test-section">
        <h2>ğŸ”Œ æµ‹è¯• WebSocket è¿æ¥</h2>
        <button onclick="testWebSocket()">æµ‹è¯• WebSocket</button>
        <div id="ws-status" class="status loading">ç­‰å¾…æµ‹è¯•...</div>
        <pre id="ws-result"></pre>
    </div>

    <script>
        async function testTickerAPI() {
            const statusEl = document.getElementById('ticker-status');
            const resultEl = document.getElementById('ticker-result');

            statusEl.textContent = 'æ­£åœ¨æµ‹è¯•...';
            statusEl.className = 'status loading';
            resultEl.textContent = '';

            try {
                const response = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT');

                if (response.ok) {
                    const data = await response.json();
                    statusEl.textContent = 'âœ… API è¿æ¥æˆåŠŸ';
                    statusEl.className = 'status success';
                    resultEl.textContent = `BTCä»·æ ¼: $${parseFloat(data.lastPrice).toFixed(2)}\n24hæ¶¨è·Œ: ${parseFloat(data.priceChangePercent).toFixed(2)}%\n24hæˆäº¤é‡: ${(parseFloat(data.volume) / 1000).toFixed(1)}K BTC`;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                statusEl.textContent = 'âŒ API è¿æ¥å¤±è´¥';
                statusEl.className = 'status error';
                resultEl.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        async function testKlineAPI() {
            const statusEl = document.getElementById('kline-status');
            const resultEl = document.getElementById('kline-result');

            statusEl.textContent = 'æ­£åœ¨æµ‹è¯•...';
            statusEl.className = 'status loading';
            resultEl.textContent = '';

            try {
                const response = await fetch('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1m&limit=5');

                if (response.ok) {
                    const data = await response.json();
                    statusEl.textContent = 'âœ… Kçº¿ API è¿æ¥æˆåŠŸ';
                    statusEl.className = 'status success';

                    const latestKline = data[data.length - 1];
                    resultEl.textContent = `è·å–åˆ° ${data.length} æ ¹Kçº¿\næœ€æ–°Kçº¿:\n  å¼€ç›˜: $${parseFloat(latestKline[1]).toFixed(2)}\n  æœ€é«˜: $${parseFloat(latestKline[2]).toFixed(2)}\n  æœ€ä½: $${parseFloat(latestKline[3]).toFixed(2)}\n  æ”¶ç›˜: $${parseFloat(latestKline[4]).toFixed(2)}`;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                statusEl.textContent = 'âŒ Kçº¿ API è¿æ¥å¤±è´¥';
                statusEl.className = 'status error';
                resultEl.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        async function testDepthAPI() {
            const statusEl = document.getElementById('depth-status');
            const resultEl = document.getElementById('depth-result');

            statusEl.textContent = 'æ­£åœ¨æµ‹è¯•...';
            statusEl.className = 'status loading';
            resultEl.textContent = '';

            try {
                const response = await fetch('https://api.binance.com/api/v3/depth?symbol=BTCUSDT&limit=5');

                if (response.ok) {
                    const data = await response.json();
                    statusEl.textContent = 'âœ… è®¢å•ç°¿ API è¿æ¥æˆåŠŸ';
                    statusEl.className = 'status success';

                    const bestBid = parseFloat(data.bids[0][0]);
                    const bestAsk = parseFloat(data.asks[0][0]);
                    const spread = bestAsk - bestBid;
                    resultEl.textContent = `ä¹°ç›˜æ·±åº¦: ${data.bids.length} æ¡£\nå–ç›˜æ·±åº¦: ${data.asks.length} æ¡£\næœ€ä¼˜ä¹°ä»·: $${bestBid.toFixed(2)}\næœ€ä¼˜å–ä»·: $${bestAsk.toFixed(2)}\nä»·å·®: $${spread.toFixed(2)}`;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                statusEl.textContent = 'âŒ è®¢å•ç°¿ API è¿æ¥å¤±è´¥';
                statusEl.className = 'status error';
                resultEl.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        function testWebSocket() {
            const statusEl = document.getElementById('ws-status');
            const resultEl = document.getElementById('ws-result');

            statusEl.textContent = 'æ­£åœ¨è¿æ¥...';
            statusEl.className = 'status loading';
            resultEl.textContent = '';

            try {
                const ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
                let messageCount = 0;
                const maxMessages = 3;
                let messages = [];

                ws.onopen = () => {
                    statusEl.textContent = 'âœ… WebSocket è¿æ¥æˆåŠŸ';
                    statusEl.className = 'status success';
                    messages.push('WebSocket è¿æ¥å·²å»ºç«‹');
                    resultEl.textContent = messages.join('\n');
                };

                ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    messageCount++;

                    messages.push(`ç¬¬ ${messageCount} æ¡æ•°æ®: ${data.s} - $${parseFloat(data.c).toFixed(2)} (${parseFloat(data.P).toFixed(2)}%)`);
                    resultEl.textContent = messages.join('\n');

                    if (messageCount >= maxMessages) {
                        ws.close();
                        statusEl.textContent = 'âœ… WebSocket æµ‹è¯•å®Œæˆ';
                    }
                };

                ws.onerror = (error) => {
                    statusEl.textContent = 'âŒ WebSocket è¿æ¥é”™è¯¯';
                    statusEl.className = 'status error';
                    resultEl.textContent = `é”™è¯¯: ${error.message || 'WebSocket è¿æ¥å¤±è´¥'}`;
                };

                ws.onclose = () => {
                    messages.push('WebSocket è¿æ¥å·²å…³é—­');
                    resultEl.textContent = messages.join('\n');
                };

                // 10ç§’åè¶…æ—¶
                setTimeout(() => {
                    if (ws.readyState === WebSocket.OPEN) {
                        ws.close();
                    }
                    if (messageCount === 0) {
                        statusEl.textContent = 'â° WebSocket æµ‹è¯•è¶…æ—¶';
                        statusEl.className = 'status error';
                        resultEl.textContent = '10ç§’å†…æœªæ”¶åˆ°æ•°æ®ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜';
                    }
                }, 10000);

            } catch (error) {
                statusEl.textContent = 'âŒ WebSocket æµ‹è¯•å¤±è´¥';
                statusEl.className = 'status error';
                resultEl.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè¯´æ˜
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ§ª Binance API æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('è¯·ç‚¹å‡»å„ä¸ªæµ‹è¯•æŒ‰é’®æ¥æ£€æŸ¥ Binance API çš„è¿æ¥çŠ¶å†µ');
        });
    </script>
</body>
</html>
