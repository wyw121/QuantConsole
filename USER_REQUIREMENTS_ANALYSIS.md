# QuantConsole 用户需求分析文档

## 📋 项目背景

基于对现有实时价格数据差异分析功能的重新评估，确定了更加实用的产品方向：**让用户自主选择交易所并绑定对应API，基于选定交易所的数据进行交易操作**。

## 🎯 核心理念

**一用户一交易所**：每个用户专注于自己选择的交易所，使用该交易所的真实数据进行交易决策，避免多交易所数据混乱和不必要的复杂性。

## 👥 目标用户

- **主要用户**：加密货币短线交易者
- **交易经验**：有一定交易基础，熟悉至少一个主流交易所
- **技术水平**：能够获取和配置交易所API密钥
- **交易习惯**：主要在单一交易所进行交易，需要专业工具提升交易效率

## 🔄 完整用户操作流程

### 阶段一：账户准备 (5-10分钟)

#### 1.1 用户注册
**用户目标**：创建QuantConsole账户
**操作步骤**：
1. 访问注册页面
2. 填写邮箱、用户名、密码
3. 邮箱验证确认
4. 设置双因素认证(可选但推荐)
5. 完成安全设置

**系统要求**：
- 强密码策略验证
- 邮箱唯一性检查
- 安全日志记录
- 防止恶意注册

#### 1.2 用户登录
**用户目标**：安全访问个人控制台
**操作步骤**：
1. 输入登录凭据
2. 双因素认证验证(如已开启)
3. 设备信息确认
4. 进入个人仪表板

**系统要求**：
- JWT安全认证
- 会话管理
- 异常登录检测
- 自动令牌刷新

### 阶段二：交易所配置 (10-15分钟)

#### 2.1 选择主要交易所
**用户目标**：确定主要交易平台
**操作步骤**：
1. 进入"交易所配置"页面
2. 从支持列表中选择交易所：
   - Binance (币安)
   - OKX (欧易)
   - Huobi (火币) - 未来支持
   - Coinbase Pro - 未来支持
3. 确认选择并保存

**系统要求**：
- 支持的交易所列表
- 交易所基础信息展示
- 用户选择持久化存储

#### 2.2 API密钥配置
**用户目标**：绑定交易所API实现数据和交易功能
**操作步骤**：
1. 在所选交易所创建API密钥
2. 在QuantConsole中填写：
   - API Key
   - Secret Key
   - Passphrase (如需要)
3. 设置API权限：
   - 只读权限(查看账户、交易记录)
   - 交易权限(下单、撤单)
   - 提现权限(可选，不推荐)
4. 测试连接验证
5. 加密存储API信息

**系统要求**：
- API密钥加密存储
- 连接测试功能
- 权限级别管理
- 错误处理和重试机制

#### 2.3 交易对配置
**用户目标**：设置关注的交易对
**操作步骤**：
1. 从交易所支持的交易对中选择
2. 设置关注列表(收藏夹)
3. 配置主要交易对
4. 设置价格提醒(可选)

**系统要求**：
- 动态获取交易所支持的交易对
- 个性化关注列表
- 交易对数据缓存
- 实时价格提醒系统

### 阶段三：控制台概览 (日常使用)

#### 3.1 仪表板总览
**用户目标**：快速了解账户和市场状态
**功能模块**：
1. **账户概览**
   - 总资产价值
   - 24h盈亏情况
   - 持仓分布饼图
   - 资产分配列表

2. **市场快照**
   - 关注交易对价格
   - 24h涨跌幅排行
   - 市场热点提醒
   - 交易所连接状态

3. **今日统计**
   - 今日交易次数
   - 今日盈亏金额
   - 成功率统计
   - 活跃交易对

4. **快捷操作**
   - 快速进入交易控制台
   - 查看最近交易
   - 设置价格提醒
   - 账户安全检查

**系统要求**：
- 实时数据更新
- 数据可视化图表
- 响应式布局设计
- 快速加载优化

#### 3.2 实时交易控制台
**用户目标**：进行专业交易操作
**核心功能**：

1. **实时市场数据**
   - 基于用户配置交易所的真实数据
   - 实时价格更新
   - K线图表分析
   - 订单簿深度显示
   - 最新成交记录

2. **交易操作面板**
   - 买入/卖出订单
   - 订单类型选择(市价/限价/止损)
   - 数量和价格设定
   - 余额检查和预估
   - 一键下单功能

3. **持仓管理**
   - 当前持仓列表
   - 持仓盈亏计算
   - 止盈止损设置
   - 仓位调整工具

4. **技术分析工具**
   - 多种技术指标
   - 自定义图表设置
   - 趋势线绘制
   - 价格提醒设置

**系统要求**：
- WebSocket实时数据流
- 低延迟订单执行
- 风险控制机制
- 交易确认流程

### 阶段四：交易记录管理 (定期使用)

#### 4.1 交易历史查看
**用户目标**：分析交易表现和改进策略
**功能需求**：
1. **交易记录列表**
   - 时间范围筛选
   - 交易对分类
   - 盈亏状态过滤
   - 排序和搜索

2. **详细交易信息**
   - 买入/卖出价格
   - 交易数量和金额
   - 手续费计算
   - 交易时机分析

3. **统计分析**
   - 总盈亏统计
   - 胜率计算
   - 平均持仓时间
   - 最佳/最差交易

4. **图表分析**
   - 盈亏曲线图
   - 交易频率分布
   - 月度/季度报表
   - 交易对表现对比

**系统要求**：
- 高效的数据查询
- 灵活的过滤条件
- 数据导出功能
- 图表可视化

#### 4.2 交易分析报告
**用户目标**：深入了解交易模式和改进方向
**功能需求**：
1. **周期性报告**
   - 每日交易总结
   - 每周表现分析
   - 每月策略回顾
   - 年度交易报告

2. **策略分析**
   - 交易模式识别
   - 成功因素分析
   - 失败原因总结
   - 改进建议提供

3. **风险评估**
   - 最大回撤计算
   - 风险收益比
   - 仓位控制分析
   - 风险提醒设置

**系统要求**：
- 智能数据分析算法
- 报告自动生成
- PDF导出功能
- 邮件报告发送

## 🔧 系统架构需求

### 前端需求
- **框架**：React + TypeScript (已实现)
- **状态管理**：Zustand (已实现)
- **图表库**：Chart.js + TradingView Widget
- **实时通信**：WebSocket连接
- **UI组件**：自定义交易组件库

### 后端需求
- **语言**：Rust + Actix-web (已实现)
- **数据库**：MySQL + Redis缓存 (已实现)
- **API集成**：交易所WebSocket和REST API
- **安全性**：JWT认证 + API密钥加密存储
- **消息队列**：Redis Pub/Sub用于实时数据

### 数据库设计
```sql
-- 用户表 (已存在)
users: id, username, email, password_hash, created_at, updated_at

-- 交易所配置表 (新增)
exchange_configs:
  id, user_id, exchange_name, api_key_encrypted,
  secret_key_encrypted, is_active, permissions, created_at

-- 交易记录表 (新增)
trades:
  id, user_id, exchange_config_id, symbol, side,
  order_type, quantity, price, fee, total_amount,
  executed_at, status, created_at

-- 持仓表 (新增)
positions:
  id, user_id, exchange_config_id, symbol,
  quantity, avg_price, unrealized_pnl, created_at, updated_at

-- 价格提醒表 (新增)
price_alerts:
  id, user_id, symbol, target_price, condition,
  is_active, triggered_at, created_at
```

## 🚀 开发优先级

### 第一阶段 (立即开发)
1. **交易所配置页面**
   - 交易所选择界面
   - API密钥配置表单
   - 连接测试功能
   - 数据加密存储

2. **控制台数据源改造**
   - 从用户配置的交易所获取数据
   - 移除多交易所数据对比功能
   - 优化单一数据源的实时性

### 第二阶段 (后续开发)
1. **交易功能集成**
   - 实际下单功能
   - 订单状态跟踪
   - 持仓管理

2. **交易记录系统**
   - 历史记录查看
   - 统计分析功能
   - 报告生成

### 第三阶段 (功能完善)
1. **高级功能**
   - 技术指标工具
   - 价格提醒系统
   - 移动端适配

2. **数据分析**
   - 交易策略分析
   - 风险管理工具
   - 智能建议系统

## 💡 用户体验优化

### 简化操作流程
- **一站式配置**：在交易所配置页面完成所有设置
- **智能默认值**：根据用户选择的交易所提供合理默认配置
- **操作指引**：提供详细的配置指南和视频教程

### 安全性保障
- **分级权限**：支持只读和交易两种API权限级别
- **安全提醒**：API配置变更时发送邮件通知
- **定期检查**：自动检测API密钥有效性

### 性能优化
- **数据缓存**：合理缓存交易所数据减少API调用
- **懒加载**：按需加载交易记录和图表数据
- **离线支持**：缓存关键数据支持网络异常时的基本功能

## 📊 成功指标

### 用户使用指标
- 用户注册转化率 > 15%
- API配置成功率 > 90%
- 日活跃用户留存率 > 60%
- 交易控制台日使用时长 > 30分钟

### 技术性能指标
- 页面加载时间 < 2秒
- 实时数据延迟 < 100ms
- API调用成功率 > 99%
- 系统可用性 > 99.5%

### 业务价值指标
- 用户交易频率提升 > 20%
- 用户满意度评分 > 4.5/5
- 功能使用深度 > 3个核心功能/用户
- 用户反馈响应时间 < 24小时

---

## 📞 下一步行动

1. **评审确认**：与开发团队评审此需求文档
2. **技术设计**：制定详细的技术实现方案
3. **原型设计**：创建交易所配置页面原型
4. **开发排期**：制定分阶段开发计划
5. **测试准备**：准备各交易所测试环境

**文档版本**：v1.0
**创建时间**：2025年7月28日
**更新周期**：根据用户反馈持续优化
