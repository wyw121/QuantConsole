# 真实数据测试指南

## 🎯 快速测试步骤

### 方法 1: 通过界面测试

1. **访问交易控制台**
   ```
   http://localhost:3001/trading
   ```

2. **打开设置面板**
   - 点击页面右上角的 "设置" 按钮
   - 在右侧会显示 "数据源配置" 面板

3. **切换到真实数据**
   - 选择 "真实数据" 选项
   - 等待连接建立（状态会显示为 "已连接"）

4. **验证数据**
   - 观察顶部价格条的实时更新
   - 检查价格图表的变化
   - 查看订单簿的真实深度数据

### 方法 2: 通过浏览器控制台测试

1. **打开开发者工具**
   - 按 F12 或右键选择 "检查"
   - 切换到 "Console" 标签页

2. **运行测试代码**
   ```javascript
   // 测试 Binance API 连接
   fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT')
     .then(response => response.json())
     .then(data => {
       console.log('BTC价格:', data.lastPrice);
       console.log('24h涨跌:', data.priceChangePercent + '%');
     });
   ```

3. **测试 WebSocket 连接**
   ```javascript
   const ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
   ws.onmessage = (event) => {
     const data = JSON.parse(event.data);
     console.log('实时价格:', data.c);
   };
   ```

### 方法 3: 使用内置测试函数

1. **在控制台中运行完整测试**
   ```javascript
   // 如果测试函数已加载，可以直接运行
   testRealMarketData().then(success => {
     if (success) {
       console.log('✅ 真实数据连接测试通过');
     } else {
       console.log('❌ 真实数据连接测试失败');
     }
   });
   ```

## 🔍 验证要点

### 实时价格数据
- [x] 顶部价格条每秒更新
- [x] 价格变化显示为绿色（上涨）或红色（下跌）
- [x] 24h涨跌幅准确显示

### K线图数据
- [x] 图表显示真实的价格走势
- [x] 成交量柱状图正确显示
- [x] 时间轴显示准确的时间

### 订单簿数据
- [x] 买盘（绿色）和卖盘（红色）深度
- [x] 价格从低到高（买盘）和从高到低（卖盘）排序
- [x] 价差计算正确

### 连接状态
- [x] 左上角显示 "已连接" 状态
- [x] 绿色WiFi图标表示连接正常
- [x] 设置面板显示 "Binance 实时数据"

## 🐛 常见问题排查

### 问题 1: 无法连接到真实数据
**症状**: 切换到真实数据后显示 "未连接"
**解决方案**:
1. 检查网络连接
2. 确认防火墙设置
3. 尝试刷新页面
4. 切换回模拟数据后再次尝试

### 问题 2: 数据更新缓慢
**症状**: 价格更新间隔超过 5 秒
**解决方案**:
1. 检查网络带宽
2. 关闭其他占用带宽的应用
3. 尝试使用不同的浏览器

### 问题 3: 订单簿数据为空
**症状**: 订单簿显示 "加载中..." 或无数据
**解决方案**:
1. 等待数据加载完成（通常需要2-3秒）
2. 切换到不同的交易对
3. 手动点击刷新按钮

### 问题 4: WebSocket 连接失败
**症状**: 控制台显示 WebSocket 错误
**解决方案**:
1. 检查企业防火墙是否阻止 WebSocket
2. 尝试使用移动热点网络
3. 联系网络管理员开放相关端口

## 📊 性能指标

### 正常的性能表现
- **连接建立时间**: < 3 秒
- **价格更新频率**: 1-2 秒
- **订单簿更新频率**: 2-3 秒
- **K线数据延迟**: < 1 分钟

### 如果性能不佳
1. 切换到模拟数据模式
2. 检查系统资源使用情况
3. 关闭不必要的浏览器标签页
4. 考虑升级网络连接

## 🔧 开发者调试

### 启用详细日志
1. 打开浏览器开发者工具
2. 在控制台中运行：
   ```javascript
   localStorage.setItem('marketDataConfig', JSON.stringify({
     dataSource: 'real',
     development: { enableLogs: true }
   }));
   ```
3. 刷新页面查看详细日志

### 监控网络请求
1. 切换到 "Network" 标签页
2. 过滤显示 "WS"（WebSocket）连接
3. 检查连接状态和数据流量

### 检查错误信息
1. 查看控制台的错误消息
2. 记录具体的错误代码
3. 如需帮助，提供错误截图

---

**提示**: 如果真实数据连接遇到问题，系统会自动回退到模拟数据，确保应用的正常使用。你可以随时在设置中重新尝试连接真实数据。
